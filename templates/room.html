<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>ØºØ±ÙØ© Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        :root { --bg: #121212; --card: #1e1e2e; --accent: #f39c12; --otaku: #8e44ad; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: white; text-align: center; padding: 20px; }
        
        .container { max-width: 500px; margin: 50px auto; background: var(--card); padding: 30px; border-radius: 20px; }
        .player-item { background: #2c3e50; margin: 10px 0; padding: 15px; border-radius: 10px; display: flex; justify-content: space-between; }
        
        .start-btn { 
            background: linear-gradient(45deg, #27ae60, #2ecc71); 
            color: white; padding: 15px 40px; border: none; border-radius: 50px; 
            font-size: 1.2rem; font-weight: bold; cursor: pointer; margin-top: 20px; width: 100%;
            display: none; /* Ù…Ø®ÙÙŠ Ø§ÙØªØ±Ø§Ø¶ÙŠØ§Ù‹ */
        }
        .start-btn:hover { transform: scale(1.05); box-shadow: 0 0 15px rgba(46, 204, 113, 0.4); }
        
        .waiting-msg { color: #888; margin-top: 20px; font-style: italic; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ØµØ§Ù„Ø© Ø§Ù„ØªØ¬Ù‡ÙŠØ²</h1>
        <p>Ø±Ù‚Ù… Ø§Ù„ØºØ±ÙØ©: <span style="color:var(--accent)">{{ room_id }}</span></p>
        
        <div id="players-list"></div>
        
        <button id="start-btn" class="start-btn" onclick="startGame()">ğŸš€ Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªØ­Ø¯ÙŠ!</button>
        <p id="wait-msg" class="waiting-msg">Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ù…Ø¶ÙŠÙ Ù„ÙŠØ¨Ø¯Ø£ Ø§Ù„Ù„Ø¹Ø¨Ø©...</p>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
    <script>
        const socket = io();
        const roomId = "{{ room_id }}";
        const isHost = sessionStorage.getItem('isHost') === 'true'; // Ù‡Ù„ Ø£Ù†Ø§ Ø§Ù„Ù…Ø¶ÙŠÙØŸ

        // Ø·Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØºØ±ÙØ© Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
        socket.on('connect', () => {
             socket.emit('get_room_details', { roomId: roomId });
        });

        // ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†
        socket.on('update_players_in_room', (players) => {
            const list = document.getElementById('players-list');
            list.innerHTML = '';
            players.forEach(p => {
                list.innerHTML += `<div class="player-item">ğŸ‘¤ ${p.name} <span style="color:var(--accent)">${p.score} Ù†Ù‚Ø·Ø©</span></div>`;
            });

            // Ù„Ùˆ Ø£Ù†Ø§ Ø§Ù„Ù…Ø¶ÙŠÙ ÙˆØ§Ù„Ø¹Ø¯Ø¯ Ù…Ù†Ø§Ø³Ø¨ØŒ Ø£Ø¸Ù‡Ø± Ø²Ø± Ø§Ù„Ø¨Ø¯Ø¡
            if (isHost) {
                document.getElementById('start-btn').style.display = 'block';
                document.getElementById('wait-msg').style.display = 'none';
            }
        });
        
        function startGame() {
            // Ù‡Ù†Ø§ Ø³Ù†Ø±Ø³Ù„ Ø¥Ø´Ø§Ø±Ø© Ø§Ù„Ø¨Ø¯Ø¡ Ù„Ù„Ø³ÙŠØ±ÙØ± Ù„Ø§Ø­Ù‚Ø§Ù‹
            alert("Ù‚Ø±ÙŠØ¨Ø§Ù‹: Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ø´Ø§Ø´Ø© Ø§Ù„Ø£Ø³Ø¦Ù„Ø©!");
        }
    </script>
</body>
</html>