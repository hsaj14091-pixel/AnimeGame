<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body { margin: 0; min-height: 100vh; display: flex; justify-content: center; align-items: center; background: linear-gradient(135deg, #1a1a1a, #2c3e50); font-family: sans-serif; color: white; padding: 20px; }
        .container { width: 100%; max-width: 800px; display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .box { background: rgba(255, 255, 255, 0.1); padding: 30px; border-radius: 15px; backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.2); }
        h2 { margin-bottom: 20px; color: #f39c12; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 10px; }
        
        label { display: block; margin-bottom: 5px; color: #ccc; font-size: 0.9rem; }
        input { width: 100%; padding: 10px; margin-bottom: 15px; border-radius: 5px; border: none; background: rgba(0,0,0,0.3); color: white; outline: none; box-sizing: border-box; }
        input:focus { border: 1px solid #f39c12; }
        
        button { width: 100%; padding: 10px; border: none; border-radius: 5px; font-weight: bold; cursor: pointer; transition: 0.3s; color: white; margin-top: 5px; }
        .btn-save { background-color: #2ecc71; } .btn-save:hover { background-color: #27ae60; }
        .btn-pass { background-color: #e74c3c; } .btn-pass:hover { background-color: #c0392b; }
        .btn-home { background-color: #3498db; margin-top: 20px; }
        
        .msg { padding: 10px; border-radius: 5px; margin-bottom: 15px; font-size: 0.9rem; grid-column: span 2; text-align: center; }
        .msg-success { background: rgba(46, 204, 113, 0.3); color: #abebc6; border: 1px solid #2ecc71; }
        .msg-error { background: rgba(231, 76, 60, 0.3); color: #ffadad; border: 1px solid #e74c3c; }

        @media (max-width: 700px) { .container { grid-template-columns: 1fr; } .msg { grid-column: span 1; } }
    </style>
</head>
<body>

    <div class="container">
        
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="msg msg-{{ category }}">{{ message }}</div>
                {% endfor %}
            {% endif %}
        {% endwith %}

        <div class="box">
            <h2>ğŸ‘¤ Ø¨ÙŠØ§Ù†Ø§ØªÙŠ</h2>
            <form action="/update_profile" method="POST">
                <label>Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… (Ø§Ù„Ù„Ù‚Ø¨)</label>
                <input type="text" name="username" value="{{ user['username'] }}" required>
                
                <label>Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ (Ù„Ø§ ÙŠÙ…ÙƒÙ† ØªØºÙŠÙŠØ±Ù‡)</label>
                <input type="email" value="{{ user['email'] }}" disabled style="opacity: 0.5; cursor: not-allowed;">
                
                <label>Ø­Ø³Ø§Ø¨ MyAnimeList (MAL)</label>
                <input type="text" name="mal_username" value="{{ user['mal_username'] or '' }}" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø­Ø³Ø§Ø¨Ùƒ ÙÙŠ MAL">
                
                <button type="submit" class="btn-save">Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª ğŸ’¾</button>
            </form>
        </div>

        <div class="box">
            <h2>ğŸ”‘ ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</h2>
            <form action="/change_password" method="POST">
                <label>ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø­Ø§Ù„ÙŠØ© (Ù„Ù„Ø£Ù…Ø§Ù†)</label>
                <input type="password" name="current_password" required placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ±Ùƒ Ø§Ù„Ø­Ø§Ù„ÙŠØ©">
                
                <label>ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©</label>
                <input type="password" name="new_password" required placeholder="********">
                
                <label>ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©</label>
                <input type="password" name="confirm_password" required placeholder="********">
                
                <button type="submit" class="btn-pass">ØªØ­Ø¯ÙŠØ« ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ğŸ”’</button>
            </form>
        </div>

        <a href="/" style="grid-column: span 2; text-decoration: none;">
            <button type="button" class="btn-home">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ© ğŸ </button>
        </a>

    </div>

</body>
</html>